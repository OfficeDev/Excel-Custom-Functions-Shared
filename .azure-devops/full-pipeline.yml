resources:
  repositories:
  - repository: m365Pipelines
    type: git
    name: 1ESPipelineTemplates/M365GPT
    ref: refs/tags/release
extends:
  template: v1/M365.Unofficial.PipelineTemplate.yml@m365Pipelines
  parameters:
    pool:
      name: Azure-Pipelines-1ESPT-ExDShared
      image: windows-2022
      os: windows
    customBuildTags:
    - ES365AIMigrationTooling
    stages:
    - stage: stage
      jobs:
      - job: Windows_10_Latest
        steps:
        - template: /.azure-devops/install.yml@self
        - template: /.azure-devops/lint.yml@self
        - template: /.azure-devops/build.yml@self
        - template: /.azure-devops/devcerts.yml@self
        - template: /.azure-devops/edgewebview.yml@self
        - template: /.azure-devops/test.yml@self
          parameters:
            webView: "edge-chromium"
      - job: WebView_EdgeLegacy
        steps:
        - template: /.azure-devops/install.yml@self
        - template: /.azure-devops/lint.yml@self
        - template: /.azure-devops/build.yml@self
        - template: /.azure-devops/devcerts.yml@self
        - template: /.azure-devops/edgewebview.yml@self
        - template: /.azure-devops/test.yml@self
          parameters:
            webView: "edge-legacy"
      - job: Mac
        steps:
        - template: /.azure-devops/install.yml@self
        - template: /.azure-devops/lint.yml@self
        - template: /.azure-devops/build.yml@self
        - template: /.azure-devops/cleanup.yml@self